<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Ben Miller - SENG480D</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="jqvmap.css" media="screen" rel="stylesheet" type="text/css"/>
    <link rel="icon" href="https://thumbs.dreamstime.com/b/data-visualization-linear-icon-modern-outline-visualizatio-logo-concept-white-background-technology-collection-suitable-133525522.jpg"/>

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="jquery.vmap.js"></script>
    <script type="text/javascript" src="maps/jquery.vmap.world.js" charset="utf-8"></script>
    <script type="text/javascript" src="js/jquery.vmap.sampledata.js"></script>
    <script src="../../../../../../node_modules/chart.js/dist/chart.js"></script>

    <script>
      jQuery(document).ready(function () {
        jQuery('#vmap').vectorMap({
          map: 'world_en',
          backgroundColor: '#ffffff',
          color: '#ffffff',
          hoverOpacity: 0.7,
          selectedColor: 'firebrick',
          enableZoom: true,
          showTooltip: true,
          scaleColors: ['#FFFFFF', '#7703fc'],
          values: sample_data,
          normalizeFunction: 'polynomial'
        });
      });

        function logData(data) {
                let sumAges = 0;
                let newData = data.filter(item => item.Gender == "Male");
                for (let i = 0; i < newData.length; i++) {
                    sumAges += parseInt(newData[i].Age);
                }
                console.log(sumAges);
        }
                                

      d3.csv("https://raw.githubusercontent.com/HactuallyBenji/workplace_visualized/main/survey.csv").then(logData);

    </script>
  </head>
  <body>
      <div id="header" style="width: 100%; height: 100px; font-size: 30px; display: flex; align-items: center; justify-content: center;">SENG480D - Ben Miller (Title)</div>
      <div id="map_filter_container" style="display: flex; justify-content: center; align-items: center;">
        <div id="vmap" style="width: 65%; height: 300px; padding-bottom: 20px; border-top: 1px solid grey"></div>
        <div id="filter_options" style="width: 20%; height: 300px; padding: 10px; border-top: 1px solid grey; display: inline-block;">
            <input type="checkbox" checked="true" id="remote" name="remote" value="Remote" style="margin-top: 5px" onchange="update()">
            <label for="remote">Remote Work</label><br>
            <input type="checkbox" checked="true" id="self_employed" name="self_employed" value="Self_Employed">
            <label for="self_employed">Self-Employed</label><br>
            <input type="checkbox" checked="true" id="family_history" name="family_history" value="Family_History">
            <label for="family_history">Family History of Mental Health Disorders</label><br>
            <input type="checkbox" checked="true" id="4" name="4" value="4">
            <label for="4">Dimension 5</label><br>
            <input type="checkbox" checked="true" id="5" name="5" value="5">
            <label for="5">Dimension 6</label><br>
            <input type="checkbox" checked="true" id="6" name="6" value="6">
            <label for="6">Dimension 7</label><br>
            <input type="range" min="18" max="72" value="18" id="age" style="height: 25px">
            <label for="age">Min Age</label><br>
            <input type="range" min="18" max="72" value="72" id="max_age" style="height: 25px">
            <label for="max_age">Max Age</label><br>
        </div>
      </div>
    <div id="scale" style="width: 100%; height: 80px; margin-left: auto; margin-right: auto;">
      <table style="margin-right: auto; margin-left: 5%; border-spacing: 0; text-align:end">
        <tr>
          <td style="width: 210px; height: 20px; background-color: #FFFFFF; margin: 0;"></td>
          <td style="width: 140px; background-color: #d6b3ff; margin: 0;"></td>
          <td style="width: 140px; background-color: #d56fff; margin: 0;"></td>
          <td style="width: 140px; background-color: #c08aff; margin: 0;"></td>
          <td style="width: 140px; background-color: #9b45ff; margin: 0;"></td>
          <td style="width: 140px; background-color: #8b26ff; margin: 0;"></td>
          <td style="width: 200px; background-color: #7600ff; margin: 0; padding: 0;"></td>
        </tr>
        <tr>
          <td style="width: 210px;"><$10,000</td>
          <td style="width: 99px">$10,000</td>
          <td style="width: 99px">$20,000</td>
          <td style="width: 99px">$30,000</td>
          <td style="width: 99px">$40,000</td>
          <td style="width: 99px">$50,000</td>
          <td style="width: 99px">>$70,000</td>
        </tr>
      </table>
    </div>
    <div class="buttonContainer" style="display: flex; justify-content: center;">
      <button type="button" onClick="update()">Update</button>
    </div>
    <br>
    <div class="chartContainer" style="display: flex; justify-content: space-around; width: 100%; height: 800px">
        <div class="chart1Container" style="width: 600px; height: 800px; text-align: center">
            <h1 id="chart1Title">First Country</h1>
            <canvas id="myChart"></canvas>
        </div>
        <div class="chart2Container" style="width: 600px; height: 800px; text-align: center">
            <h1 id="chart2Title">Second Country</h1>
            <canvas id="myChart2"></canvas>
        </div>
    </div>


    <script>
        function getData(data) {
          const remote = document.getElementById('remote').checked;
          const rmt = remote ? "Yes" : "No";
          console.log(remote);
          console.log(rmt);
          const selfEmployed = document.getElementById('self_employed').checked;
          const slfEmpld = selfEmployed ? "Yes" : "No";
          console.log(selfEmployed);
          const familyHistory = document.getElementById('family_history').checked;
          const fmlHstry = familyHistory ? "Yes" : "No";
          console.log(familyHistory);

          const minAge = document.getElementById('age').value;
          console.log(minAge);

          const maxAge = document.getElementById('max_age').value;
          console.log(maxAge);

          const country1 = document.getElementById('chart1Title').innerHTML;
          console.log(country1);

          const country2 = document.getElementById('chart2Title').innerHTML;

          console.log('DATA: ');
          console.log(data);

          // filter out remote_work
          let newData1 = data.filter(item => item.remote_work === rmt && item.self_employed === slfEmpld);
          let newData2 = data.filter(item => item.remote_work === rmt);

          console.log(newData1);

          // filter out self_employed
          newData1.filter(item => item.self_employed === slfEmpld);
          newData2.filter(item => item.self_employed === slfEmpld);

          // filter out family_history
          newData1.filter(item => item.family_history === fmlHstry && item.Country === 'Canada');
          newData2.filter(item => item.family_history === fmlHstry);

          // filter country
         

          console.log('NEW DATA');
          console.log(newData1);
        }

        let data = [12, 10, 3, 5, 2, 4];
        let data2 = [-5, -4, -5, -8, -2, -1, -4];
        function update() {
            data = [5, 4, 5, 8, 2, 1, 4];
            
            myChart.data.datasets[0].data = data;
            myChart.data.datasets[1].data = data2;
            myChart.update();
            console.log(data);

            myChart2.data.datasets[0].data = data;
            myChart2.data.datasets[1].data = data2;
            myChart2.update();
            d3.csv("https://raw.githubusercontent.com/HactuallyBenji/workplace_visualized/main/survey.csv").then(getData);
        }

      const ctx = document.getElementById('myChart').getContext('2d');
      const myChart = new Chart(ctx, {
          type: 'bar',
          data: {
              labels: ['Mental Health Benefits', 'Wellness Program', 'Mental Health Leave', 'Mental Health as Important as Physical', 'Comfortable Sharing Mental Health w/ Coworkers'],
              datasets: [{
                  label: '# Yes Responses',
                  data: [12, 10, 3, 5, 2],
                  backgroundColor: 
                      
                      'rgba(54, 162, 235, 0.2)',
                  
                  borderColor: 
                      'rgba(54, 162, 235, 1)',
                  borderWidth: 1
              },
                {
                  label: '# No Responses',
                  data: [-1, -11, -4, -6, -3],
                  backgroundColor: 
                  'rgba(255, 99, 132, 0.2)',
                  borderColor: 
                      'rgba(255, 99, 132, 1)',
                  
                  borderWidth: 1
                }

            ]
          },
          options: {
              responsive: true,
              plugins: {
                legend: {
                  position: 'top',
                },
                title: {
                  display: false,
                  text: 'Country 1'
                }
              }
          }
      });
      

      const ctx2 = document.getElementById('myChart2').getContext('2d');
      const myChart2 = new Chart(ctx2, {
          type: 'bar',
          data: {
              labels: ['Mental Health Benefits', 'Wellness Program', 'Mental Health Leave', 'Mental Health as Important as Physical', 'Comfortable Sharing Mental Health w/ Coworkers'],
              datasets: [{
                  label: '# Yes Responses',
                  data: [12, 10, 3, 5, 2],
                  backgroundColor: 
                      
                      'rgba(54, 162, 235, 0.2)',
                  
                  borderColor: 
                      'rgba(54, 162, 235, 1)',
                  borderWidth: 1
              },
                {
                  label: '# No Responses',
                  data: [-1, -11, -4, -6, -3],
                  backgroundColor: 
                  'rgba(255, 99, 132, 0.2)',
                  borderColor: 
                      'rgba(255, 99, 132, 1)',
                  
                  borderWidth: 1
                }

            ]
          },
          options: {
              responsive: true,
              plugins: {
                legend: {
                  position: 'top',
                },
                title: {
                  display: false,
                  text: 'Country 2'
                }
              }
          }
      });
      </script>
  </body>
</html>
